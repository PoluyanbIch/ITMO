## Билет 8. Теорема Татта о совершенном паросочетании.
> *Обозначение*: $o(G)$ - **количество нечётных компонент связности** произвольного  графа $G$ (то есть, компонент связности, содержащих нечётное число вершин).

### Теорема Татта
**(W. T. Tutte, 1947.)** В графе $G$ существует **совершенное паросочетание** *тогда и только тогда, когда* для любого $S \subset V (G)$ **выполняется условие** $o(G − S) \leq |S|$
> *Повторение:* Совершенное паросочетание - покрывающее все вершины графа.
> *Повторение:* [билет 1](#билет-1.-независимые-множества-паросочетания-и-покрытия-в-графе.-теорема-галлаи.)

#### Доказательство
$\Rightarrow$ 
*Необходимость условия почти очевидна*. 
- Пусть $S \subset V (G)$, а $M$ — совершенное паросочетание. 
- Тогда **одна из вершин каждой нечетной компоненты** связности графа $G − S$ должна быть **соединена с вершиной из** $S$ ребром паросочетания $M$ и все эти вершины — разные!
> *Объяснение*: "должна быть соединена с вершиной из $S$" (*в* ***нечетной*** *компоненте связности* ***нечётное*** *число вершин* $\Rightarrow$ *останется ровно одна вершина,* ***непокрытая*** *паросочетанием*), 
- А значит должно выполняться $o(G − S) \leq |S|$

$\Leftarrow$ 
*Докажем от противного*
- Предположим, что граф удовлетворяет условию, но **не имеет совершенного паросочетания**. Тогда, в частности, $o(G-\varnothing) \leq |\varnothing| = 0$, то есть, $v(G)$ **чётно**.
- Пусть $G^∗$ — **максимальный надграф** $G$ на том же множестве вершин, **не имеющий совершенного паросочетания**. Мы **построим** совершенное паросочетание в $G^∗$ и придем к противоречию.
- Для любого $S \subset V (G)$ очевидно, выполняется неравенство 
$o(G^∗ − S) \leq o(G − S) \leq |S|$.
- Пусть $U = \{u \in V(G) : d_{G^∗}(u) = v (G) − 1\}$. 
Очевидно, $G^∗$ — **не полный граф**, поэтому $U \neq V(G)$.
> *Объяснение*: из-за $d_{G^∗}(u) = v (G) − 1$ мы получили, что вершины $U$ смежны всем вершинам подграфа

*Докажем, что граф* $G^∗ − \ U$ *— объединение нескольких несвязанных друг с другом полных графов*
##### Поддоказательство (от противного)
- Предположим, что это не так. Тогда **существуют** такие **вершины** $x$, $y$ , $z \in V(G) \setminus U$, 
что $xy$, $yz \in E(G^∗)$, но $xz \not\in E(G^∗)$.
- Так как $y \not\in U$, то **существует** такая **вершина** $w \not\in U$, что $yw \not\in E(G^∗)$.
- Ввиду максимальности графа $G^∗$ существуют:
**совершенное паросочетание** $M_1$ в графе $G^∗ + xz$,
**совершенное паросочетание** $M_2$ в графе $G^∗ + yw$. 
Так как в графе $G^∗$ нет совершенного паросочетания, $xz \in M_1$ и $yw \in M_2$.
- Пусть $H = (V(G), M_1 \Delta M_2)$. Очевидно, граф $H$ — **несвязное объединение чётных циклов**, в каждом из которых **чередуются** рёбра паросочетаний $M_1$ и $M_2$.
> *Объяснение*: Так как $M_1 \Delta M_2$ - **симметрическая разность**, в графе $H$ будет **равное количество рёбер** из $M_1$ и $M_2$. 
> *Объяснение*: **Нечётных циклов** быть **не может**, так как **рёбра** после удаления повторяющихся **чередуются**, а их **количество** в каждой компоненте **одинаково**. 
> *Объяснение*: **Путей** быть **не может**, так как паросочетания были **совершенными** и мы удаляли только повторяющиеся рёбра. 

- Рёбра $xz$ и $yw$ принадлежат **ровно одному из паросочетаний** $M_1$ и $M_2$, и потому **лежат в** $E(H)$.
- На вершинах **любой компоненты** связности графа $H$ **существует совершенное паросочетание** с рёбрами из $M_1$ и **совершенное паросочетание** с рёбрами из $M_2$.

*Рассмотрим два случая*.
**Случай 1. Рёбра** $xz$ **и** $yw$ **лежат в разных компонентах** $C_1$ **и** $C_2$ **графа** $H$
- Тогда на вершинах $C_1$ мы **выберем рёбра паросочетания** $M_2$, 
на вершинах $C_2$ мы **выберем рёбра паросочетания** $M_1$, 
а в остальных **компонентах** графа $H$ — **любое из этих паросочетаний**.
- В итоге получится **совершенное паросочетание** графа $G^∗$, противоречие.

**Случай 2. Рёбра** $xz$ **и** $yw$ **лежат в одной компоненте** $C$ **графа** $H$.
![Tutte](https://github.com/Dkanil/ITMO/blob/main/semester1/DM/Tutte.png?raw=true)
- В силу **симметричности** $x$ и $z$ можно считать, что вершины расположены **в чётном цикле** $C$ в порядке $ywzx$ (см. рисунок).
- Рассмотрим **простой путь** $P = xCyzCw$ , состоящий из **двух дуг цикла** $C$ и **ребра** $yz$ (*оно есть в графе* $G^*$ *по построению*). 
- Тогда $V(P) = V (C)$ и $E(P) \subset E(G^∗)$. 
- Следовательно, существует **совершенное паросочетание** $M_C \subset E (G^∗)$ **на вершинах компоненты** связности $C$.
- В остальных **компонентах** графа $H$ выберем рёбра **любого из паросочетаний** $M_1$ и $M_2$. 
- В итоге получится **совершенное паросочетание** графа $G^∗$, противоречие.

*Вернёмся к [основному доказательству](#поддоказательство-от-противного)*
- **Граф** $G^∗ − \ U$ есть **объединение** нескольких **несвязанных полных графов**. В силу условия $o(G − U) \leq |U|$, среди них **не более чем** $|U|$ имеет **нечетное** число вершин.
- В каждой **чётной компоненте** графа $G^∗ − \ U$ мы построим **полное паросочетание**, 
- В каждой **нечётной компоненте** — **паросочетание**, покрывающее все вершины, **кроме одной**, а оставшуюся вершину **соединим с вершиной из** $U$ (*при этом мы используем* ***различные вершины*** *множества* $U$: *их хватит ввиду* $o(G^∗ − \ U) \leq |U|)$.
- Наконец, мы **разобьём на пары оставшиеся** непокрытыми вершины множества $U$ (*это можно сделать, так как каждая из этих вершин* ***смежна*** *в графе* $U$ *со всеми остальными по построению графа* $U$). 
- Таким образом, мы получили **совершенное паросочетание** в графе $G^∗$, противоречие.